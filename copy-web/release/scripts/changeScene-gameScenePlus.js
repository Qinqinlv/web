!function(){function a(){o[0]().play(),addSceneChangeEvent({stage:i,sceneBuilder:o,sceneIndex:r})}function n(){var n=new Konva.Layer,e=getProgressBar({x:1/8*i.width(),y:i.height()/2,width:.75*i.width(),height:.05*i.height(),fillStyle:"#3CB371",strokeStyle:" #2E8B57",lineWidth:6,opacity:.7});return getCreateScene({name:"场景1",stage:i,layers:[n],init:function(){var a=this;e.addToGroupOrLayer(a.layers[0]),this.layers.forEach(function(n){a.stage.add(n)})},entrance:function(){function n(){var n=Number(t/d.length).toFixed(2);e.changeValue(n,.5),n>=1&&a()}e.group.to({opacity:1,duration:.1});var t=0;d.forEach(function(a,e){var i=new Image;i.src="./public/images/changeScene/"+a,i.onload=function(){t++,h[d[e]]=i,n()}})},departure:function(a){new Konva.Tween({node:e.group,scaleX:0,scaleY:0,y:0,x:i.width()/2,duration:1,opacity:0,easing:Konva.Easings.EaseIn,onFinish:function(){n.destroy()}}).play(),a()}})}var e=window.innerWidth,t=window.innerHeight;t-=e>=768?80:71;var i=new Konva.Stage({container:"sceneContainer",width:e,height:t}),o=[function(){var a=new Konva.Layer,n=new Konva.Layer,e=new Konva.Layer,t=[{name:"jQuery",value:.2,color:"#00868B"},{name:"Ajax",value:.4,color:"#00CED1"},{name:"Canvas",value:.1,color:"#4EEE94"},{name:"AngularJS",value:.1,color:"#66CD00"},{name:"NodeJS",value:.2,color:"#00CD66"}],o=getHistogramChart({data:t,x:1/8*i.width(),y:.75*i.height(),height:i.height()/2,width:.75*i.width(),opacity:0}),r=new Konva.Image({width:i.width(),height:i.height(),image:h["light.png"],opacity:.1}),d=new Konva.Image({width:i.width(),height:i.height(),image:h["light-color.png"],opacity:.9});return getCreateScene({name:"场景3",stage:i,layers:[n,a,e],init:function(){var t=this;o.addToGroupOrLayer(a),n.add(d),e.add(r),this.layers.forEach(function(a){t.stage.add(a)})},entrance:function(a){o.totalGroup.to({duration:.001,opacity:1,onFinish:function(){o.playAnimation()}}),new Konva.Tween({node:r,opacity:.9,duration:3,yoyo:!0}).play()},departure:function(a){var n=this;new Konva.Tween({node:o.totalGroup,opacity:0,scaleX:.1,scaleY:.1,y:0,x:i.width(),duration:1,easing:Konva.Easings.EaseIn,onFinish:function(){n.layers.forEach(function(a){a.destroy()}),a()}}).play()}})},function(){var a=new Konva.Layer,n=new Konva.Layer,e=new Konva.Layer;ringRadius=2/3*(i.width()>i.height()?i.height():i.width());var t=getRingScene({stage:i,ringRadius:ringRadius,cenX:-.25*i.width(),opacity:.2}),o=new Konva.Image({width:i.width(),height:i.height(),image:h["light-color.png"],opacity:.9}),r=new Konva.Image({width:i.width(),height:i.height(),image:h["light.png"],opacity:.1});return getCreateScene({name:"场景2",stage:i,layers:[n,e,a],init:function(){var i=this;t.addToGroupOrLayer(a),n.add(o),e.add(r),this.layers.forEach(function(a){i.stage.add(a)})},entrance:function(n){t.bigGroup.to({duration:.6,opacity:1,x:.75*i.width(),onFinish:function(){t.playAnimation(a)}}),new Konva.Tween({node:r,opacity:.9,duration:3,yoyo:!0}).play()},departure:function(a){var n=this;t.bigGroup.to({duration:.6,x:5/4*i.width(),onFinish:function(){n.layers.forEach(function(a){a.destroy()}),a()}})}})},function(){var a=new Konva.Layer,n=new Konva.Layer,e=new Konva.Layer,t=[{name:"html5",value:.25,color:"#00C5CD"},{name:"css3",value:.2,color:"#76EE00"},{name:"Angular",value:.3,color:"#00CD66"},{name:"jQuery",value:.05,color:"#00868B"},{name:"Ajax",value:.1,color:"#00CD00"},{name:"Node",value:.1,color:"#AEEEEE"}],o=i.width()>i.height()?i.height():i.width(),r=getPieChart({data:t,animateDuration:1,easing:Konva.Easings.EaseIn,x:0,y:i.height()/2,opacity:0,radius:.28*o,textDistance:.06*o}),d=new Konva.Image({width:i.width(),height:i.height(),image:h["light.png"],opacity:.1}),c=new Konva.Image({width:i.width(),height:i.height(),image:h["light-color.png"],opacity:.9});return getCreateScene({name:"饼状图场景",stage:i,layers:[n,a,e],init:function(){n.add(c),e.add(d),r.addToGroupOrLayer(a);var t=this;this.layers.forEach(function(a){t.stage.add(a)})},entrance:function(){new Konva.Tween({node:d,opacity:.9,duration:3,yoyo:!0}).play(),r.group.to({x:i.width()/2,duration:.6,opacity:.9,onFinish:function(){r.playAnimate()}})},departure:function(a){var n=this;new Konva.Tween({node:r.group,opacity:0,scaleX:.1,scaleY:.1,y:0,x:i.width()/2,duration:.6,easing:Konva.Easings.EaseIn,onFinish:function(){n.layers.forEach(function(a){a.destroy()}),a()}}).play()}})},function(){var a=new Konva.Layer,n=new Konva.Layer,e=new Konva.Image({width:i.width(),height:i.height(),image:h["light-color.png"],opacity:.9}),t=new Konva.Text({x:0,y:.1*i.height(),text:"微信场景转换动画",fontSize:i.width()<500?20:24,fontFamily:"微软雅黑",fill:"#333",width:.5*i.width(),align:"center"}),o=new Konva.Rect({x:0,y:0,height:.25*i.height(),width:.5*i.width(),stroke:"gole",strokeWidth:5,shadowColor:"black",shadowBlur:10,shadowOffset:[10,10],shadowOpacity:.2,cornerRadius:10}),r=new Konva.Group({x:i.width(),y:i.height(),scaleX:.7,scaleY:.7});r.add(o),r.add(t);var d=new Konva.Group({x:0,y:0}),c=new Konva.Image({image:h["text.png"],width:1/8*i.width(),height:1/8*i.width(),x:10,scaleX:.5,scaleY:.5,y:-.2*i.width(),opacity:.9});d.add(c);var s=new Konva.Image({image:h["little5.png"],width:2/3*i.width(),x:5/4*i.width(),y:1/9*i.height()});return d.add(s),getCreateScene({name:"文字场景",stage:i,layers:[n,a],init:function(){n.add(e),a.add(r),a.add(d);var t=this;this.layers.forEach(function(a){t.stage.add(a)})},entrance:function(){new Konva.Tween({node:r,opacity:.9,x:.25*i.width(),y:2/3*i.height(),duration:1,scaleX:1,scaleY:1,opacity:.5,easing:Konva.Easings.EaseIn,onFinish:function(){}}).play(),s.to({x:1/6*i.width(),scaleX:1.2,opacity:.6,duration:.8,easing:Konva.Easings.EaseOut}),c.to({y:1/8*i.width(),scaleX:.8,scaleY:.8,opacity:.6,duration:.8,easing:Konva.Easings.EaseOut,yoyo:!0})},departure:function(a){var n=this;s.to({x:5/4*i.width(),scaleX:.5,scaleY:.5,opacity:.4,duration:.6,easing:Konva.Easings.EaseOut}),c.to({y:-1/8*i.width(),scaleX:.5,scaleY:.5,opacity:.5,duration:.6,easing:Konva.Easings.EaseOut}),new Konva.Tween({node:r,opacity:0,scaleX:.1,scaleY:.1,y:0,x:i.width()/2,duration:.6,easing:Konva.Easings.EaseIn,onFinish:function(){n.layers.forEach(function(a){a.destroy()}),a()}}).play()}})}],r=0,h={},d=["light.png","light-color.png","little5.png","text.png"];n().play()}();